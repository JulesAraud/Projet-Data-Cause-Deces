<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Analyse des D√©c√®s Mondiaux</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <h1>Analyse des D√©c√®s dans le Monde</h1>

    <h2>‚û§ Pays avec le plus grand nombre de d√©c√®s</h2>
    <canvas id="chart1"></canvas>

    <h2>‚û§ √âvolution des d√©c√®s dus au diab√®te (par ann√©e)</h2>
    <canvas id="chart2"></canvas>

    <h2>‚û§ Top 10 causes de mortalit√©</h2>
    <canvas id="chart3"></canvas>

    <h2>‚û§ Cause ayant le plus augment√© / diminu√© entre 1990 et 2019</h2>
    <div id="chart4"></div>

    <h2>‚û§ Pays les plus touch√©s par les maladies non transmissibles</h2>
    <canvas id="chart5"></canvas>
  </div>

  <script>
    // 1. Pays avec le plus de d√©c√®s
    fetch('/api/deaths/top-deaths-country')
      .then(res => res.json())
      .then(data => {
        new Chart(document.getElementById('chart1'), {
          type: 'bar',
          data: {
            labels: data.map(d => d.country),
            datasets: [{
              label: 'D√©c√®s totaux',
              data: data.map(d => d.totalDeaths),
              backgroundColor: 'rgba(255, 99, 132, 0.5)'
            }]
          }
        });
      });

    // 2. √âvolution des d√©c√®s dus au diab√®te
    fetch('/api/deaths/diabetes-evolution')
      .then(res => res.json())
      .then(data => {
        new Chart(document.getElementById('chart2'), {
          type: 'line',
          data: {
            labels: data.map(d => d._id),
            datasets: [{
              label: 'D√©c√®s diab√®te',
              data: data.map(d => d.totalDiabetesDeaths),
              borderColor: 'blue',
              backgroundColor: 'rgba(0,0,255,0.1)',
              fill: true,
              tension: 0.3
            }]
          }
        });
      });

    // 3. Top 10 causes
    fetch('/api/deaths/top-causes')
      .then(res => res.json())
      .then(data => {
        new Chart(document.getElementById('chart3'), {
          type: 'bar',
          data: {
            labels: data.map(d => d.cause),
            datasets: [{
              label: 'D√©c√®s',
              data: data.map(d => d.totalDeaths),
              backgroundColor: 'orange'
            }]
          }
        });
      });

    // 4. Cause avec + / - de variation entre 1990 et 2019
    fetch('/api/deaths/cause-evolution')
      .then(res => res.json())
      .then(data => {
        const el = document.getElementById('chart4');
        el.innerHTML = `
          <p>üìà <strong>${data.causeWithMostIncrease.cause}</strong> a le plus augment√© : +${data.causeWithMostIncrease.diff.toLocaleString()} d√©c√®s</p>
          <p>üìâ <strong>${data.causeWithMostDecrease.cause}</strong> a le plus diminu√© : ${data.causeWithMostDecrease.diff.toLocaleString()} d√©c√®s</p>
        `;
      });

    // 5. Pays les plus touch√©s par maladies non transmissibles
    fetch('/api/deaths/non-communicable')
      .then(res => res.json())
      .then(data => {
        new Chart(document.getElementById('chart5'), {
          type: 'bar',
          data: {
            labels: data.map(d => d.country),
            datasets: [{
              label: 'D√©c√®s maladies non transmissibles',
              data: data.map(d => d.totalNonCommunicableDeaths),
              backgroundColor: 'green'
            }]
          }
        });
      });
  </script>
</body>
</html>
